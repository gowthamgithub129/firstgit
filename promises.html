<!DOCTYPE html>
<html>
<head>
    <title>Post Creation</title>
</head>
<body>
    <script>
        // Sample user object
        const user = {
            name: "John",
            lastActivityTime: null
        };

        const posts = [];

        // Simulating post creation
        function createPost(post) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    posts.push(post);
                    resolve();
                }, 1000);
            });
        }

        // Simulating updating user's last activity time
        function updateLastUserActivityTime() {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    user.lastActivityTime = new Date();
                    resolve();
                }, 1000);
            });
        }

        // Simulating post deletion
        function deleteLastPost() {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (posts.length > 0) {
                        const deletedPost = posts.pop();
                        resolve(deletedPost);
                    } else {
                        reject("ERROR: No posts to delete.");
                    }
                }, 1000);
            });
        }

        // Creating a new post
        const newPost = { title: "New Post", body: "This is the content of the new post." };
        createPost(newPost)
            .then(() => updateLastUserActivityTime())
            .then(() => {
                console.log("All promises resolved.");
                console.log("Posts:", posts);
                console.log("Last Activity Time:", user.lastActivityTime);
                return deleteLastPost();
            })
            .then((deletedPost) => {
                console.log("Deleted Post:", deletedPost);
                console.log("New Posts:", posts);
            })
            .catch((error) => {
                console.log(error);
            });
    </script>
</body>
</html>
